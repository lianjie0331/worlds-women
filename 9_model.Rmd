---
title: "Modeling"
author: "Rochelle Terman"
date: "December 14, 2015"
output: html_document
---

#### Table of Contents

1. Prepare Data
2. Logit
3. Negative Binomial
4. OLS
5. Robustness Tests

```{r}
rm(list=ls())
setwd("~/Dropbox/berkeley/Git-Repos/worlds-women")

library(plyr)
library("MASS")
library("xtable")
library(plm)
library(ggplot2)
library(stargazer) # pretty tables
library(statar) # for missing values
library(sandwich) # for robust standard errors
library(lmtest) # for robust standard errors
library(data.table)  # for missing valus
library(sampleSelection) # for heckman correction
library(car)
library(pscl)
source("interaction_plots.R")
library(mfx)
```

# 1. Prepare Data

```{r}
rt.orig <- read.csv("Data/country-year/original.csv")
rt.nearest <- read.csv("Data/country-year/nearest.csv")
rt.imputed <- read.csv("Data/country-year/imputed.csv")

# set database
rt <- rt.orig

# Deal with Palestine (without ccode)
rt$ccode[is.na(rt$ccode)] <- 999

# set dv
rt$rights <- rt$rights.mean
rt$gbv <- rt$gbv.mean

# composite women's rights
rt$women_composite <- rowMeans(cbind(rt$wopol,rt$wosoc,rt$wecon), na.rm = T)

# Summarize Data
stargazer(rt, type="text", out = "Data/country-year/summary.txt")

# subset with an observation
rt.1 <- rt[rt$n.binary==1,]
summary(rt.1$muslim)

# israel
rt$mena[rt$ccode == 666] <- 1

# n.obs
nrow(rt[rt$year>1979,])

# make panel data
rt <- pdata.frame(rt, c("ccode","year"))
```

# 2. Logit Model on Reports (Binary)

## 2.1 Full Models

```{r}
# MUSLIM MAJORITY
logit1 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt, family = binomial(link="probit"))
logit1.se <- coeftest(logit1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

jpeg("Results/regressions/interactive-plots/logit1.jpeg",width=700,height=500,type="quartz")
interaction_plot_binary(logit1, effect="lag(women_composite, 1)", moderator="lag(muslim.maj, 1)", interaction="lag(women_composite, 1):lag(muslim.maj, 1)", factor_labels=c("Not Muslim","Muslim"), xlabel="Muslim majority", ylabel="Marginal Effect of Women's Rights on Coverage", title="")
dev.off()

# MENA
logit2 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*mena + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt, family = "binomial"(link="probit"))
logit2.se <- coeftest(logit2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

jpeg("Results/regressions/interactive-plots/logit2.jpeg",width=700,height=500,type="quartz")
interaction_plot_binary(logit2, effect="lag(women_composite, 1)", moderator="mena", interaction="lag(women_composite, 1):mena", factor_labels=c("Not Mena","Mena"), xlabel="Mena", ylabel="Marginal Effect of Women's Rights on Coverage", title="")
dev.off()

# PERCENT MUSLIM
logit3 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt, family = "binomial"(link="probit"))
logit3.se <- coeftest(logit3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

jpeg("Results/regressions/interactive-plots/logit3.jpeg",width=700,height=500,type="quartz")
interaction_plot_continuous(logit3, effect="lag(women_composite, 1)", moderator="lag(muslim, 1)", interaction="lag(women_composite, 1):lag(muslim, 1)", mean=T, title="",xlabel="Percentage Muslim", ylabel="Marginal Effect of Women's Rights on Coverage")
dev.off()

# PRINT
stargazer(logit1, logit2, logit3, out = "Results/regressions/main-results/probit.tex", type = "latex", label = "table:probit", style = "ajps", title = "Probit Analysis of U.S. News Coverage about Women Abroad", se = list(logit1.se, logit2.se, logit3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Reported (Binary)", covariate.labels=c("Lagged DV", "Country Reports", "Women's Rights Index","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Instability", "Population", "GDP per capita", "Women's Rights x Muslim Majority", "Women's Rights x MENA","Women's Rights x Muslim Percentage"), star.cutoffs = c(0.05, 0.01, .001))
```

## 2.2 Partial Models

To respond to critiques that the findings are model dependent, this adds covariates one by one. Uses only Muslim majority for now. 

TODO: MENA and Muslim Percentage in Robustness tests.

```{r}
# basic model (women's rights * muslim majority)
part.logit.1 <- glm(n.binary ~ lag(women_composite,1)*lag(muslim.maj,1), data = rt, family = binomial(link="probit"))
part.logit.1.se <- coeftest(part.logit.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# add Country Reports
part.logit.2 <- glm(n.binary ~ lag(women_composite,1)*lag(muslim.maj,1) + lag(count, 1), data = rt, family = binomial(link="probit"))
part.logit.2.se <- coeftest(part.logit.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# add Democracy
part.logit.3 <- glm(n.binary ~ lag(women_composite,1)*lag(muslim.maj,1) + lag(count, 1) + lag(polity2,1), data = rt, family = binomial(link="probit"))
part.logit.3.se <- coeftest(part.logit.3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# add Instability
part.logit.4 <- glm(n.binary ~ lag(women_composite,1)*lag(muslim.maj,1) + lag(count, 1) + lag(polity2,1) + lag(domestic9,1), data = rt, family = binomial(link="probit"))
part.logit.4.se <- coeftest(part.logit.4, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# add Population
part.logit.5 <- glm(n.binary ~ lag(women_composite,1)*lag(muslim.maj,1) + lag(count, 1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)), data = rt, family = binomial(link="probit"))
part.logit.5.se <- coeftest(part.logit.5, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# add GDP
part.logit.6 <- glm(n.binary ~ lag(women_composite,1)*lag(muslim.maj,1) + lag(count, 1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)), data = rt, family = binomial(link="probit"))
part.logit.6.se <- coeftest(part.logit.6, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# write
stargazer(part.logit.1, part.logit.2, part.logit.3, part.logit.4, part.logit.5, part.logit.6, out = "Results/regressions/robust/probit-part.tex", type = "latex", label = "table:probit", style = "ajps", title = "Probit Analysis of U.S. News Coverage about Women Abroad", se = list(part.logit.1.se, part.logit.2.se, part.logit.3.se, part.logit.4.se, part.logit.5.se, part.logit.6.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Reported (Binary)", covariate.labels=c("Women's Rights Index","Muslim Majority", "Country Reports", "Democracy", "Instability", "Population", "GDP per capita", "Women's Rights x Muslim Majority"), star.cutoffs = c(0.05, 0.01, .001))
```

## 2.3 OLS 

```{r}
lm.binary<- lm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
summary(lm.binary)
coeftest(lm.binary, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))
```

## 2.4 Robustness Tests

### 2.4.1 Replacing Women's Rights Composit with Women's Political Rights

```{r}
# muslim majority
logit.r1.1 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wopol,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt, family = "binomial")
logit.r1.1.se <- coeftest(logit.r1.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# mena
logit.r1.2 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wopol,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt, family = "binomial")
logit.r1.2.se <- coeftest(logit.r1.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# muslim percentage
logit.r1.3 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wopol,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt, family = "binomial")
logit.r1.3.se <- coeftest(logit.r1.3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(logit.r1.1, logit.r1.2, logit.r1.3, type = "latex", out = "Results/regressions/robust/probit-1.tex", style = "ajps", title = "H1.A: Women's Political Rights", se = list(logit.r1.1.se, logit.r1.2.se, logit.r1.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Reported (Binary)", covariate.labels=c("Lagged DV", "Country Reports", "Women's Rights Index","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Instability", "Population", "GDP per capita", "Women's Rights x Muslim Majority", "Women's Rights x MENA","Women's Rights x Muslim Percentage"), star.cutoffs = c(0.05, 0.01, .001))
```

### 2.4.2 Replacing Women's Rights Composit with Women's Social Rights

```{r}
# muslim majority
logit.r2.1 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wosoc,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt, family = "binomial")
logit.r2.1.se <- coeftest(logit.r2.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# mena
logit.r2.2 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wosoc,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt, family = "binomial")
logit.r2.2.se <- coeftest(logit.r2.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# muslim percentage
logit.r2.3 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wosoc,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt, family = "binomial")
logit.r2.3.se <- coeftest(logit.r2.3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(logit.r2.1, logit.r2.2, logit.r2.3, type = "latex", out = "Results/regressions/robust/probit-2.tex", style = "ajps", title = "H1.A: Women's Social Rights", se = list(logit.r2.1.se, logit.r2.2.se, logit.r2.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Reported (Binary)", covariate.labels=c("Lagged DV", "Country Reports", "Women's Rights Index","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Instability", "Population", "GDP per capita", "Women's Rights x Muslim Majority", "Women's Rights x MENA","Women's Rights x Muslim Percentage"), star.cutoffs = c(0.05, 0.01, .001))
```

### 2.4.3 Replacing Women's Rights Composit with Women's Economic Rights

```{r}
# muslim majority
logit.r3.1 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wecon,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt, family = "binomial")
logit.r3.1.se <- coeftest(logit.r3.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# mena
logit.r3.2 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wecon,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt, family = "binomial")
logit.r3.2.se <- coeftest(logit.r3.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# muslim percentage
logit.r3.3 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wecon,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt, family = "binomial")
logit.r3.3.se <- coeftest(logit.r3.3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(logit.r3.1, logit.r3.2, logit.r3.3, type = "latex", style = "ajps", out = "Results/regressions/robust/probit-3.tex", title = "H1.A: Women's Economic Rights", se = list(logit.r3.1.se, logit.r3.2.se, logit.r3.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Reported (Binary)", covariate.labels=c("Lagged DV", "Country Reports", "Women's Rights Index","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Instability", "Population", "GDP per capita", "Women's Rights x Muslim Majority", "Women's Rights x MENA","Women's Rights x Muslim Percentage"), star.cutoffs = c(0.05, 0.01, .001))
```

### 2.4.4 Remove Israel from MENA

```{r}
rt.no.israel <- rt
rt.no.israel$mena[rt.no.israel$ccode == 666] <- 0

# muslim majority
logit.r4.1 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt.no.israel, family = "binomial")
logit.r4.1.se <- coeftest(logit.r4.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# mena
logit.r4.2 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt.no.israel, family = "binomial")
logit.r4.2.se <- coeftest(logit.r4.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# muslim percentage
logit.r4.3 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt.no.israel, family = "binomial")
logit.r4.3.se <- coeftest(logit.r4.3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(logit.r4.1, logit.r4.2, logit.r4.3, type = "latex", out = "Results/regressions/robust/probit-4.tex", style = "ajps", title = "H1.A: Israel Removed from MENA", se = list(logit.r4.1.se, logit.r4.2.se, logit.r4.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Reported (Binary)", covariate.labels=c("Lagged DV", "Country Reports", "Women's Rights Index","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Instability", "Population", "GDP per capita", "Women's Rights x Muslim Majority", "Women's Rights x MENA","Women's Rights x Muslim Percentage"), star.cutoffs = c(0.05, 0.01, .001))
```

### 2.4.5 Missing Data - Multiple Imputation 

Polity missing???

```{r}
rt.imputed$rights <- rt.imputed$rights.mean
rt.imputed$rights[is.na(rt.imputed$rights)] <- 0
rt.imputed$women_composite <- rowMeans(cbind(rt.imputed$wopol,rt.imputed$wosoc,rt.imputed$wecon), na.rm = T)
rt.imputed <- pdata.frame(rt.imputed, c("ccode","year"))

# muslim majority
logit.r5.1 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt.imputed, family = "binomial")
logit.r5.1.se <- coeftest(logit.r5.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# mena
logit.r5.2 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt.imputed, family = "binomial")
logit.r5.2.se <- coeftest(logit.r5.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# muslim percentage
logit.r5.3 <- glm(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt.imputed, family = "binomial")
logit.r5.3.se <- coeftest(logit.r5.3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(logit.r5.1, logit.r5.2, logit.r5.3, type = "latex", out = "Results/regressions/robust/probit-6.tex", title = "H1.A: Missing Data using Multiple Imputation", style = "ajps", se = list(logit.r5.1.se, logit.r5.2.se, logit.r5.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Reported (Binary)", covariate.labels=c("Lagged DV", "Country Reports", "Women's Rights","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Instability", "Population", "GDP per capita", "Women's Rights x Muslim Majority", "Women's Rights x MENA","Women's Rights x Muslim Percentage"), star.cutoffs = c(0.05, 0.01, 0.001))


```

# 3. Negative Binomial Model on Reports (Count)

## 3.1 Full Models

```{r}
# MUSLIM MAJORITY
nb1 <- glm.nb(n.docs ~ lag(n.docs, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
summary(nb1)
nb1.se <- coeftest(nb1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

jpeg("Results/regressions/interactive-plots/nb1.jpeg",width=700,height=500,type="quartz")
interaction_plot_binary(nb1, effect="lag(women_composite, 1)", moderator="lag(muslim.maj, 1)", interaction="lag(women_composite, 1):lag(muslim.maj, 1)", factor_labels=c("Not Muslim Majority","Muslim Majority"), xlabel="", ylabel="Marginal Effect of Women's Rights on Coverage", title="")
dev.off()

# MENA
nb2 <- glm.nb(n.docs ~ lag(n.docs, 1) + lag(count, 1) + lag(women_composite,1)*mena + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
summary(nb2)
nb2.se <- coeftest(nb2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

jpeg("Results/regressions/interactive-plots/nb2.jpeg",width=700,height=500,type="quartz")
interaction_plot_binary(nb2, effect="lag(women_composite, 1)", moderator="mena", interaction="lag(women_composite, 1):mena", factor_labels=c("Not Mena","Mena"), xlabel="", ylabel="Marginal Effect of Women's Rights on Coverage", title="")
dev.off()

# MUSLIM PERCENTAGE
nb3 <- glm.nb(n.docs ~ lag(n.docs, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
summary(nb3)
nb3.se <- coeftest(nb3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

jpeg("Results/regressions/interactive-plots/nb3.jpeg",width=700,height=500,type="quartz")
interaction_plot_continuous(nb3, effect="lag(women_composite, 1)", moderator="lag(muslim, 1)", interaction="lag(women_composite, 1):lag(muslim, 1)", mean=T, title="",xlabel="Percentage Muslim", ylabel="Marginal Effect of Women's Rights on Coverage")
dev.off()

# PRINT
stargazer(nb1, nb2, nb3, type = "latex", out = "Results/regressions/tables/negbin.tex", label = "table:negbin", title = "Negative Binomial Analysis of U.S. News Coverage about Women Abroad", style = "ajps", se = list(nb1.se, nb2.se, nb3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Reported (Count)", covariate.labels=c("Lagged DV", "Country Reports", "Women's Rights Index","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Instability", "Population", "GDP per capita", "Women's Rights x Muslim Majority", "Women's Rights x MENA","Women's Rights x Muslim Percentage"), star.cutoffs = c(0.05, 0.01, 0.001))
```

## 3.2 Partial Models

To respond to critiques that the findings are model dependent, this adds covariates one by one. Uses only Muslim majority for now. 

TODO: MENA and Muslim Percentage in Robustness tests.

```{r}
# basic model (women's rights * muslim majority)
part.nb.1 <- glm.nb(n.docs ~ lag(women_composite,1)*lag(muslim.maj,1), data = rt)
part.nb.1.se <- coeftest(part.nb.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# add Country Reports
part.nb.2 <- glm.nb(n.docs ~ lag(women_composite,1)*lag(muslim.maj,1) + lag(count, 1), data = rt)
part.nb.2.se <- coeftest(part.nb.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# add Democracy
part.nb.3 <- glm.nb(n.docs ~ lag(women_composite,1)*lag(muslim.maj,1) + lag(count, 1) + lag(polity2, 1), data = rt)
part.nb.3.se <- coeftest(part.nb.3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# add Instability
part.nb.4 <- glm.nb(n.docs ~ lag(women_composite,1)*lag(muslim.maj,1) + lag(count, 1) + lag(polity2, 1) + lag(domestic9, 1), data = rt)
part.nb.4.se <- coeftest(part.nb.4, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# add Population
part.nb.5 <- glm.nb(n.docs ~ lag(women_composite,1)*lag(muslim.maj,1) + lag(count, 1) + lag(polity2, 1) + lag(domestic9, 1) + log(lag(pop.wdi,1)), data = rt)
part.nb.5.se <- coeftest(part.nb.5, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# add GDP
part.nb.6 <- glm.nb(n.docs ~ lag(women_composite,1)*lag(muslim.maj,1) + lag(count, 1) + lag(polity2, 1) + lag(domestic9, 1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)), data = rt)
part.nb.6.se <- coeftest(part.nb.6, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# write
stargazer(part.nb.1, part.nb.2, part.nb.3, part.nb.4, part.nb.5, part.nb.6, out = "Results/regressions/robust/negbin-part.tex", type = "latex", label = "table:probit", style = "ajps", title = "Probit Analysis of U.S. News Coverage about Women Abroad", se = list(part.nb.1.se, part.nb.2.se, part.nb.3.se, part.nb.4.se, part.nb.5.se, part.nb.6.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Reported (Count)", covariate.labels=c("Women's Rights Index","Muslim Majority", "Country Reports", "Democracy", "Instability", "Population", "GDP per capita", "Women's Rights x Muslim Majority"), star.cutoffs = c(0.05, 0.01, .001))
```

## 3.3 OLS

### 3.3.1 With lagged DV
```{r}
lm.count.1 <- lm(n.docs ~ lag(n.docs, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
summary(lm.count.1)
coeftest(lm.count.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))
```

### 3.3.1 Without lagged DV
```{r}
lm.count.2 <- lm(n.docs ~ lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
summary(lm.count.2)
coeftest(lm.count.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))
```

## 3.4 Robustness Tests

### 3.4.1 Replacing Women's Rights Composit with Women's Political Rights

```{r}
# muslim majority
nb.r1.1 <- glm.nb(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wopol,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
nb.r1.1.se <- coeftest(nb.r1.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# mena
nb.r1.2 <- glm.nb(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wopol,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
nb.r1.2.se <- coeftest(nb.r1.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# muslim percentage
nb.r1.3 <- glm.nb(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wopol,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
nb.r1.3.se <- coeftest(nb.r1.3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(nb.r1.1, nb.r1.2, nb.r1.3, type = "latex",  out = "Results/regressions/robust/negbin-1.tex", title = "H1.B: Women's Political Rights", style = "ajps", se = list(nb.r1.1.se, nb.r1.2.se, nb.r1.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Reported (Count)", covariate.labels=c("Lagged DV", "Country Reports", "Women's Political Rights","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Instability", "Population", "GDP per capita", "Women's Rights x Muslim Majority", "Women's Rights x MENA","Women's Rights x Muslim Percentage"), star.cutoffs = c(0.05, 0.01, 0.001), omit.stat = "theta")
```

### 3.4.2 Replacing Women's Rights Composit with Women's Social Rights

```{r}
# muslim majority
nb.r2.1 <- glm.nb(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wosoc,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
nb.r2.1.se <- coeftest(nb.r2.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# mena
nb.r2.2 <- glm.nb(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wosoc,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
nb.r2.2.se <- coeftest(nb.r2.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# muslim percentage
nb.r2.3 <- glm.nb(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wosoc,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
nb.r2.3.se <- coeftest(nb.r2.3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(nb.r2.1, nb.r2.2, nb.r2.3, type = "latex", out = "Results/regressions/robust/negbin-2.tex", title = "H1.B: Women's Social Rights", style = "ajps", se = list(nb.r2.1.se, nb.r2.2.se, nb.r2.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Reported (Count)", covariate.labels=c("Lagged DV", "Country Reports", "Women's Social Rights","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Instability", "Population", "GDP per capita", "Women's Rights x Muslim Majority", "Women's Rights x MENA","Women's Rights x Muslim Percentage"), star.cutoffs = c(0.05, 0.01, 0.001), omit.stat = "theta")
```

### 3.4.3 Replacing Women's Rights Composit with Women's Economic Rights

```{r}
# muslim majority
nb.r3.1 <- glm.nb(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wecon,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
nb.r3.1.se <- coeftest(nb.r3.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# mena
nb.r3.2 <- glm.nb(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wecon,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
nb.r3.2.se <- coeftest(nb.r3.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# muslim percentage
nb.r3.3 <- glm.nb(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wecon,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt)
nb.r3.3.se <- coeftest(nb.r3.3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(nb.r3.1, nb.r3.2, nb.r3.3, type = "latex", out = "Results/regressions/robust/negbin-3.tex", title = "H1.B: Women's Economic Rights", style = "ajps", se = list(nb.r3.1.se, nb.r3.2.se, nb.r3.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Reported (Count)", covariate.labels=c("Lagged DV", "Country Reports", "Women's Economic Rights","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Instability", "Population", "GDP per capita", "Women's Rights x Muslim Majority", "Women's Rights x MENA","Women's Rights x Muslim Percentage"), star.cutoffs = c(0.05, 0.01, 0.001), omit.stat = "theta")
```

### 3.4.4 Remove Israel from MENA

```{r}
rt.no.israel <- rt
rt.no.israel$mena[rt.no.israel$ccode == 666] <- 0

# muslim majority
nb.r4.1 <- glm.nb(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt.no.israel)
nb.r4.1.se <- coeftest(nb.r4.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# mena
nb.r4.2 <- glm.nb(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt.no.israel)
nb.r4.2.se <- coeftest(nb.r4.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# muslim percentage
nb.r4.3 <- glm.nb(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt.no.israel)
nb.r4.3.se <- coeftest(nb.r4.3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(nb.r4.1, nb.r4.2, nb.r4.3, type = "latex", out = "Results/regressions/robust/negbin-4.tex", title = "H1.B: Removing Israel from MENA", style = "ajps", se = list(nb.r4.1.se, nb.r4.2.se, nb.r4.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Reported (Count)", covariate.labels=c("Lagged DV", "Country Reports", "Women's Economic Rights","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Instability", "Population", "GDP per capita", "Women's Rights x Muslim Majority", "Women's Rights x MENA","Women's Rights x Muslim Percentage"), star.cutoffs = c(0.05, 0.01, 0.001), omit.stat = "theta")
```

### 3.4.5 Missing Data - Multiple Imputation

```{r}
rt.imputed$rights <- rt.imputed$rights.mean
rt.imputed$rights[is.na(rt.imputed$rights)] <- 0
rt.imputed$women_composite <- rowMeans(cbind(rt.imputed$wopol,rt.imputed$wosoc,rt.imputed$wecon), na.rm = T)
rt.imputed <- pdata.frame(rt.imputed, c("ccode","year"))

# muslim majority
nb.r5.1 <- glm.nb(n.docs ~ lag(n.docs, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt.imputed)
nb.r5.1.se <- coeftest(nb.r5.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# mena
nb.r5.2 <- glm.nb(n.docs ~ lag(n.docs, 1) + lag(count, 1) + lag(women_composite,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt.imputed)
nb.r5.2.se <- coeftest(nb.r5.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# muslim percentage
nb.r5.3 <- glm.nb(n.docs ~ lag(n.docs, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),data = rt.imputed)
nb.r5.3.se <- coeftest(nb.r5.3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(nb.r5.1, nb.r5.2, nb.r5.3, type = "latex", out = "Results/regressions/robust/negbin-6.tex", title = "H1.B: Missing Data, Multiple Imputation", style = "ajps", se = list(nb.r5.1.se, nb.r5.2.se, nb.r5.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Reported (Count)", covariate.labels=c("Lagged DV", "Country Reports", "Women's Rights","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Instability", "Population", "GDP per capita", "Women's Rights x Muslim Majority", "Women's Rights x MENA","Women's Rights x Muslim Percentage"), star.cutoffs = c(0.05, 0.01, 0.001),omit.stat = "theta")
```

# 4. Heckit Models

## 4.1 Full Models

```{r}
## Muslim Majority
heckit1 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                 rights ~ lag(rights, 1) + lag(women_composite,1) + lag(muslim.maj,1) + lag(polity2, 1) + lag(physint,1),
                 rt )
summary(heckit1)
heckit1.se = coeftest(heckit1$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]
heckit1.se

# MENA
heckit2 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                  rights ~ lag(rights, 1) + lag(women_composite,1) + lag(mena,1) + lag(polity2, 1) + lag(physint,1),
                  rt )
heckit2.se = coeftest(heckit2$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# Muslim percentage
heckit3 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                  rights ~ lag(rights, 1) + lag(women_composite,1) + lag(muslim,1) + lag(polity2, 1) + lag(physint,1),
                  rt )
summary(heckit3$lm)
heckit3.se = coeftest(heckit3$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# print
stargazer(heckit1$lm, heckit2$lm, heckit3$lm, type = "latex", out = "Results/regressions/tables/heckit.tex", label = "table:heckit", style = "ajps", title = "Two-Step Analysis of Rights Focus in U.S. News Coverage about Women Abroad", se = list(heckit1.se, heckit2.se, heckit3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Rights Focus", covariate.labels=c("Intercept", "Lagged DV", "Women's Rights Index","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Physical Integrity Rights"), star.cutoffs = c(0.05, 0.01, 0.001))
```

## 4.2 Partial Models

```{r}
# Basic model - rights and muslim.maj
part.heckit.1 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                 rights ~ lag(women_composite,1) + lag(muslim.maj,1),
                 rt )
part.heckit.1.se = coeftest(part.heckit.1$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# Add Democracy
part.heckit.2 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                 rights ~ lag(women_composite,1) + lag(muslim.maj,1) + lag(polity2, 1),
                 rt )
part.heckit.2.se = coeftest(part.heckit.2$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# Add Physical Integrity
part.heckit.3 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                 rights ~ lag(women_composite,1) + lag(muslim.maj,1) + lag(polity2, 1) + lag(physint,1),
                 rt )
part.heckit.3.se = coeftest(part.heckit.3$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# print
stargazer(part.heckit.1$lm, part.heckit.2$lm, part.heckit.3$lm, type = "latex", out = "Results/regressions/robust/heckit-part.tex", label = "table:heckit", style = "ajps", title = "Two-Step Analysis of Rights Focus in U.S. News Coverage about Women Abroad", se = list(part.heckit.1.se, part.heckit.2.se, part.heckit.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Rights Focus", covariate.labels=c("Intercept", "Women's Rights Index","Muslim Majority", "Democracy", "Physical Integrity Rights", "Lagged DV"), star.cutoffs = c(0.05, 0.01, 0.001))
```

## 4.3 Robustness Tests

### 4.3.1 Replacing Women's Rights Composit with Women's Political Rights

```{r}
# muslim maj
heckit.r1.1 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wopol,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights) + lag(wopol,1) + lag(muslim.maj,1) + lag(polity2, 1) + lag(physint,1),
                      rt)
heckit.r1.1.se <- coeftest(heckit.r1.1$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# mena
heckit.r1.2 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wopol,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights) + lag(wopol,1) + lag(mena,1) + lag(polity2, 1) + lag(physint,1),
                      rt )
heckit.r1.2.se <- coeftest(heckit.r1.2$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# muslim perc.
heckit.r1.3 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wopol,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights) + lag(wopol,1) + lag(muslim,1) + lag(polity2, 1) + lag(physint,1),
                      rt )
heckit.r1.3.se <- coeftest(heckit.r1.3$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT 
stargazer(heckit.r1.1$lm, heckit.r1.2$lm, heckit.r1.3$lm, type = "latex", out = "Results/regressions/robust/heckit-5.tex", style = "ajps", title = "H2: Women's Political Rights", se = list(heckit.r1.1.se, heckit.r1.2.se, heckit.r1.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Rights Focus", covariate.labels=c("Intercept", "Lagged DV", "Women's Political Rights","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Physical Integrity Rights"), star.cutoffs = c(0.05, 0.01, 0.001), df = F)
```

### 4.3.2 Replacing Women's Rights Composit with Women's Social Rights

```{r}
# muslim maj
heckit.r2.1 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wosoc,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights) + lag(wosoc,1) + lag(muslim.maj,1) + lag(polity2, 1) + lag(physint,1),
                      rt)
heckit.r2.1.se <- coeftest(heckit.r2.1$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# mena
heckit.r2.2 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wosoc,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights) + lag(wosoc,1) + lag(mena,1) + lag(polity2, 1) + lag(physint,1),
                      rt )
heckit.r2.2.se <- coeftest(heckit.r2.2$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# muslim perc.
heckit.r2.3 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wosoc,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights) + lag(wosoc,1) + lag(muslim,1) + lag(polity2, 1) + lag(physint,1),
                      rt )
heckit.r2.3.se <- coeftest(heckit.r2.3$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(heckit.r2.1$lm, heckit.r2.2$lm, heckit.r2.3$lm, type = "latex", out = "Results/regressions/robust/heckit-6.tex", style = "ajps", title = "H2: Women's Social Rights", se = list(heckit.r2.1.se, heckit.r2.2.se, heckit.r2.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Rights Focus", covariate.labels=c("Intercept", "Lagged DV", "Women's Social Rights","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Physical Integrity Rights"), star.cutoffs = c(0.05, 0.01, 0.001), df = F)
```

### 4.3.3 Replacing Women's Rights Composit with Women's Economic Rights

```{r}
# muslim maj
heckit.r3.1 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wecon,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights) + lag(wecon,1) + lag(muslim.maj,1) + lag(polity2, 1) + lag(physint,1),
                      rt)
heckit.r3.1.se <- coeftest(heckit.r3.1$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# mena
heckit.r3.2 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wecon,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights) + lag(wecon,1) + lag(mena,1) + lag(polity2, 1) + lag(physint,1),
                      rt )
heckit.r3.2.se <- coeftest(heckit.r3.2$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# muslim perc.
heckit.r3.3 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(wecon,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights) + lag(wecon,1) + lag(muslim,1) + lag(polity2, 1) + lag(physint,1),
                      rt )
heckit.r3.3.se <- coeftest(heckit.r3.3$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(heckit.r3.1$lm, heckit.r3.2$lm, heckit.r3.3$lm, type = "latex", out = "Results/regressions/robust/heckit-7.tex", style = "ajps", title = "H2: Women's Economic Rights", se = list(heckit.r3.1.se, heckit.r3.2.se, heckit.r3.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Rights Focus", covariate.labels=c("Intercept", "Lagged DV", "Women's Economic Rights","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Physical Integrity Rights"), star.cutoffs = c(0.05, 0.01, 0.001), df = F)
```

### 4.3.4 Removing Israel from MENA

```{r}
rt.no.israel <- rt
rt.no.israel$mena[rt.no.israel$ccode == 666] <- 0

# muslim maj
heckit.r4.1 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights, 1) + lag(women_composite,1) + lag(muslim.maj,1) + lag(polity2, 1) + lag(physint,1),
                      rt.no.israel)
heckit.r4.1.se <- coeftest(heckit.r4.1$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# mena
heckit.r4.2 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights, 1) + lag(women_composite,1) + lag(mena,1) + lag(polity2, 1) + lag(physint,1),
                      rt.no.israel )
heckit.r4.2.se <- coeftest(heckit.r4.2$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# muslim perc.
heckit.r4.3 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights, 1) + lag(women_composite,1) + lag(muslim,1) + lag(polity2, 1) + lag(physint,1),
                      rt.no.israel )
heckit.r4.3.se <- coeftest(heckit.r4.3$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(heckit.r4.1$lm, heckit.r4.2$lm, heckit.r4.3$lm, out = "Results/regressions/robust/heckit-2.tex", type = "latex", style = "ajps", title = "H2: Removing Israel from MENA", se = list(heckit.r4.1.se, heckit.r4.1.se, heckit.r4.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Rights Focus", covariate.labels=c("Intercept", "Lagged DV", "Women's Rights Index","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Physican Integrity Rights"), star.cutoffs = c(0.05, 0.01, 0.001), df = F)
```

### 4.3.5 Missing Data - Multiple Imputation

### 4.3.6 Fractional Logit 

```{r}
heckit.r6.1 <- glm(rights ~ lag(rights, 1) + lag(women_composite,1) + lag(muslim.maj,1) + lag(polity2, 1) + lag(physint,1), data = rt, family=binomial(link="logit"), weights = n.words)
summary(heckit.r6.1)
heckit.r6.1.se <- coeftest(heckit.r6.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

heckit.r6.2 <- glm(rights ~ lag(rights, 1) + lag(women_composite,1) + lag(mena,1) + lag(polity2, 1) + lag(physint,1), data = rt, family=binomial(link="logit"), weights = n.words)
summary(heckit.r6.2)
heckit.r6.2.se <- coeftest(heckit.r6.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

heckit.r6.3 <- glm(rights ~ lag(rights, 1) + lag(women_composite,1) + lag(muslim,1) + lag(polity2, 1) + lag(physint,1), data = rt, family=binomial(link="logit"), weights = n.words)
summary(heckit.r6.3)
heckit.r6.3.se <- coeftest(heckit.r6.3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

stargazer(heckit.r6.1, heckit.r6.2, heckit.r6.3, type = "latex", out = "Results/regressions/robust/heckit-3.tex", style = "ajps", title = "H2: Fractional Logit", se = list(heckit.r6.1.se, heckit.r6.2.se, heckit.r6.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Rights Focus", covariate.labels=c("Lagged DV", "Women's Rights Index","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Physical Integrity Rights"), star.cutoffs = c(0.05, 0.01, 0.001), df = F)
```

### 4.3.7 Fractional Logit without Lagged DV

```{r}
rt$rights <- rt$rights.mean
heckit.r7.1 <- glm(rights ~ lag(women_composite,1) + lag(muslim.maj,1) + lag(polity2, 1) + lag(physint,1), data = rt, family=binomial(link="logit"), weights = n.words)
summary(heckit.r7.1)
heckit.r7.1.se <- coeftest(heckit.r7.1, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

heckit.r7.2 <- glm(rights ~lag(women_composite,1) + lag(mena,1) + lag(polity2, 1) + lag(physint,1), data = rt, family=binomial(link="logit"), weights = n.words)
summary(heckit.r7.1)
heckit.r7.2.se <- coeftest(heckit.r7.2, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

heckit.r7.3 <- glm(rights ~ lag(women_composite,1) + lag(muslim,1) + lag(polity2, 1) + lag(physint,1), data = rt, family=binomial(link="logit"), weights = n.words)
summary(heckit.r7.1)
heckit.r7.3.se <- coeftest(heckit.r7.3, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

stargazer(heckit.r7.1, heckit.r7.2, heckit.r7.3, type = "latex", style = "ajps", out = "Results/regressions/robust/heckit-4.tex", title = "H2: Fractional Logit without lagged DV", se = list(heckit.r7.1.se, heckit.r7.2.se, heckit.r7.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Rights Focus", covariate.labels=c("Women's Rights Index","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Physical Integrity Rights"), star.cutoffs = c(0.05, 0.01, 0.001), df = F)
```

### 4.3.8 Use Rights Boolean instead of Rights Means

```{r}
rt$rights <- rt$rights.boolean

# Muslim Majority
heckit.r8.1 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights, 1) + lag(women_composite,1) + lag(muslim.maj,1) + lag(polity2, 1) + lag(physint,1),
                      rt )
heckit.r8.1.se = coeftest(heckit.r8.1$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]
heckit.r8.1.se

# MENA
heckit.r8.2 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights, 1) + lag(women_composite,1) + lag(mena,1) + lag(polity2, 1) + lag(physint,1),
                      rt )
heckit.r8.2.se = coeftest(heckit.r8.2$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# Muslim percentage
heckit.r8.3 <- heckit(n.binary ~ lag(n.binary, 1) + lag(count, 1) + lag(women_composite,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                      rights ~ lag(rights, 1) + lag(women_composite,1) + lag(muslim,1) + lag(polity2, 1) + lag(physint,1),
                      rt )
summary(heckit.r8.3$lm)
heckit.r8.3.se = coeftest(heckit.r8.3$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(heckit.r8.1$lm, heckit.r8.2$lm, heckit.r8.3$lm, type = "latex", out = "Results/regressions/robust/heckit-8.tex", style = "ajps", title = "H2: With Alternative Estimate of DV", se = list(heckit.r8.1.se, heckit.r8.2.se, heckit.r8.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Rights (Binary)", covariate.labels=c("Intercept", "Lagged DV", "Women's Rights Index","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Physical Integrity Rights"), star.cutoffs = c(0.05, 0.01, 0.001), df = F)
```

### 4.3.9 Use Rights Boolean instead of Rights Means, without lagged DV

```{r}
rt$rights <- rt$rights.boolean

# Muslim Majority
heckit.r9.1 <- heckit(n.binary ~ lag(count, 1) + lag(women_composite,1)*lag(muslim.maj,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                  rights ~ lag(women_composite,1) + lag(muslim.maj,1) + lag(polity2, 1) + lag(physint,1),
                  rt )
heckit.r9.1.se = coeftest(heckit.r9.1$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]
heckit.r9.1.se

 # MENA
heckit.r9.2 <- heckit(n.binary ~lag(count, 1) + lag(women_composite,1)*lag(mena,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                  rights ~ lag(women_composite,1) + lag(mena,1) + lag(polity2, 1) + lag(physint,1),
                  rt )
heckit.r9.2.se = coeftest(heckit.r9.2$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# Muslim percentage
heckit.r9.3 <- heckit(n.binary ~ lag(count, 1) + lag(women_composite,1)*lag(muslim,1) + lag(polity2,1) + lag(domestic9,1) + log(lag(pop.wdi,1)) + log(lag(gdp.pc.un,1)),
                  rights ~ lag(women_composite,1) + lag(muslim,1) + lag(polity2, 1) + lag(physint,1),
                  rt )
summary(heckit.r9.3$lm)
heckit.r9.3.se = coeftest(heckit.r9.3$lm, vcov=function(x) vcovHC(x, cluster="group", type="HC1"))[,2]

# PRINT
stargazer(heckit.r9.1$lm, heckit.r9.2$lm, heckit.r9.3$lm, type = "latex", out = "Results/regressions/robust/heckit-9.tex", style = "ajps", title = "H2: With Alternative Estimate of DV and without lagged DV", se = list(heckit.r9.1.se, heckit.r9.2.se, heckit.r9.3.se), notes="Robust standard errors clustered on country appear in parentheses.",  dep.var.labels = "Rights (Binary)", covariate.labels=c("Intercept", "Women's Rights Index","Muslim Majority","MENA", "Muslim Percentage", "Democracy", "Physical Integrity Rights"), star.cutoffs = c(0.05, 0.01, 0.001), df = F)
```
